# FeedlyAI 프로젝트 발표 자료

## 📋 슬라이드 1: 프로젝트 소개

### FeedlyAI - AI 기반 인스타그램 광고 자동 생성 시스템

**프로젝트명**: FeedlyAI  
**목적**: 사용자 입력만으로 완전 자동화된 인스타그램 광고 이미지와 피드 글 생성

**핵심 가치**:
- ✅ **완전 자동화**: 수동 개입 없이 전체 파이프라인 실행
- ✅ **실시간 이벤트 기반**: PostgreSQL LISTEN/NOTIFY 활용
- ✅ **다단계 품질 평가**: OCR, 가독성, IoU 평가
- ✅ **완전한 추적**: 모든 LLM 호출 및 파이프라인 단계 추적

---

## 📋 슬라이드 2: 프로젝트 목적 및 배경

### 문제 정의

**기존 방식의 한계**:
- 수동으로 각 단계를 순차적으로 호출해야 함
- 주기적 폴링으로 인한 리소스 낭비
- 여러 워커 인스턴스 간 동기화 어려움
- 메모리 부족으로 인한 시스템 불안정

### 해결 방안

**FeedlyAI의 접근**:
- 이벤트 기반 자동화 아키텍처
- 실시간 상태 감지 및 자동 트리거
- 메모리 최적화 (8-bit 양자화, Swap Area)
- 완전한 추적 및 모니터링 시스템

---

## 📋 슬라이드 3: 전체 아키텍처

### 시스템 구조

```
┌─────────────────────────────────────────────────────────┐
│                    사용자 입력                            │
│  (한국어 설명, 톤&스타일, 스토어 정보)                    │
└─────────────────────────────────────────────────────────┘
                        ↓
┌─────────────────────────────────────────────────────────┐
│              JS 파트 (텍스트 생성)                        │
│  - 한국어 → 영어 변환                                     │
│  - 영어 광고문구 생성                                     │
└─────────────────────────────────────────────────────────┘
                        ↓
┌─────────────────────────────────────────────────────────┐
│              YE 파트 (이미지 생성)                        │
│  - 이미지 생성                                           │
└─────────────────────────────────────────────────────────┘
                        ↓
┌─────────────────────────────────────────────────────────┐
│              YH 파트 (이미지 처리 및 평가)                 │
│  ┌──────────────────────────────────────────────────┐   │
│  │  Variant별 처리 (8단계)                           │   │
│  │  - vlm_analyze (LLaVA 검증)                       │   │
│  │  - yolo_detect (금지 영역 감지)                   │   │
│  │  - planner (텍스트 배치 계획)                      │   │
│  │  - overlay (텍스트 오버레이)                       │   │
│  │  - vlm_judge (최종 품질 평가)                     │   │
│  │  - ocr_eval (OCR 평가)                            │   │
│  │  - readability_eval (가독성 평가)                  │   │
│  │  - iou_eval (위치 정확도 평가)                     │   │
│  └──────────────────────────────────────────────────┘   │
│                        ↓                                 │
│  ┌──────────────────────────────────────────────────┐   │
│  │  Job 레벨 처리 (2단계)                             │   │
│  │  - ad_copy_gen_kor (영어 → 한글 변환)              │   │
│  │  - instagram_feed_gen (피드 글 생성)              │   │
│  └──────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
                        ↓
┌─────────────────────────────────────────────────────────┐
│              최종 결과물                                   │
│  - 오버레이된 광고 이미지 (3개 variants)                 │
│  - 인스타그램 피드 글 + 해시태그                         │
└─────────────────────────────────────────────────────────┘
```

### 핵심 컴포넌트

1. **PostgreSQL LISTEN/NOTIFY**: 실시간 이벤트 기반 트리거
2. **Job State Listener**: 상태 변화 감지 및 파이프라인 트리거
3. **AI 모델 통합**: LLaVA, YOLO, GPT
4. **품질 평가 시스템**: OCR, 가독성, IoU 평가
5. **모니터링 시스템**: LLM 추적, Job 상태 관리

---

## 📋 슬라이드 4: 자동화 및 트리거 시스템

### PostgreSQL LISTEN/NOTIFY 기반 자동화

**핵심 기술**:
- 이벤트 기반 아키텍처 (폴링 방식 아님)
- 실시간 반응 (지연 시간 최소화)
- 완전 자동화 (수동 개입 불필요)

**동작 원리**:
```
[데이터베이스 상태 업데이트]
  ↓
[PostgreSQL 트리거]
  ↓
[NOTIFY 이벤트 발행]
  ↓
[FastAPI 리스너 감지]
  ↓
[다음 단계 API 자동 호출]
```

**주요 특징**:
- ✅ 10단계 파이프라인 완전 자동화
- ✅ 자동 재연결 및 장애 복구
- ✅ 뒤처진 Variants 자동 복구
- ✅ 중복 실행 방지

---

## 📋 슬라이드 5: AI 모델 통합

### 멀티모달 AI 활용

#### 1. LLaVA (Large Language and Vision Assistant)
- **목적**: 이미지-텍스트 일관성 검증 및 품질 평가
- **특징**: 
  - Stage 1: 이미지-텍스트 검증
  - Stage 2: 최종 품질 평가
  - 8-bit 양자화로 메모리 50% 절약
  - Thread-safe 모델 로딩

#### 2. YOLO (You Only Look Once)
- **목적**: 텍스트 오버레이 금지 영역 감지
- **특징**: 
  - 실시간 객체 감지 (< 1초)
  - Segmentation 마스크 생성
  - 텍스트 배치 최적화

#### 3. GPT (Generative Pre-trained Transformer)
- **목적**: 텍스트 생성 및 변환
- **특징**: 
  - 한국어 ↔ 영어 변환
  - 광고문구 생성
  - 인스타그램 피드 글 생성
  - 완전한 LLM 호출 추적

---

## 📋 슬라이드 6: 이미지 처리 및 오버레이

### Planner Service
- **기능**: 텍스트 오버레이 위치 및 스타일 계획
- **입력**: YOLO 감지 결과, 광고문구
- **출력**: 레이아웃 제안 (위치, 크기, 스타일)

### Overlay Service
- **기능**: 이미지에 텍스트 오버레이 적용
- **특징**: 
  - 한글 폰트 완벽 지원 (나눔고딕)
  - 고품질 텍스트 렌더링
  - 자동 레이아웃 최적화

---

## 📋 슬라이드 7: 품질 평가 시스템

### 3단계 평가 시스템

#### 1. OCR 평가
- **목적**: 오버레이된 텍스트의 OCR 인식 정확도 평가
- **기술**: EasyOCR (한글, 영어 지원)
- **메트릭**: 신뢰도, 정확도, 문자/단어 일치율

#### 2. 가독성 평가
- **목적**: 텍스트와 배경의 대비 분석
- **메트릭**: 가독성 점수, 시각적 품질

#### 3. IoU 평가
- **목적**: 오버레이된 텍스트와 원본 제안 위치의 일치도 평가
- **메트릭**: 바운딩 박스 IoU, 위치 정확도

**결과**: 다면적 품질 평가로 고품질 광고 이미지 보장

---

## 📋 슬라이드 8: 텍스트 생성 및 변환

### 텍스트 생성 파이프라인

```
[사용자 입력]
한국어 설명 + 톤&스타일
  ↓
[한국어 → 영어 변환]
GPT API 호출
  ↓
[광고문구 생성]
GPT API 호출 (영어)
  ↓
[영어 → 한글 변환]
GPT API 호출
  ↓
[인스타그램 피드 생성]
GPT API 호출 (한글 피드 + 해시태그)
  ↓
[최종 결과]
인스타그램 피드 글 + 해시태그
```

**특징**:
- ✅ 모든 LLM 호출 추적 (llm_traces)
- ✅ 토큰 사용량 모니터링
- ✅ 비용 관리 및 최적화

---

## 📋 슬라이드 9: 모니터링 및 추적

### 완전한 추적 시스템

#### LLM 추적 (llm_traces)
- 모든 GPT 호출 저장
- 요청/응답 (JSONB)
- 토큰 사용량 추적
- 지연 시간 측정
- 모델 정보 추적

#### Job 및 Variant 상태 관리
- Job 레벨 상태 추적
- Variant별 독립적 진행 추적
- 단계별 상태 기록
- 재시도 메커니즘 (retry_count)

**장점**:
- ✅ 완전한 감사 추적
- ✅ 성능 분석 가능
- ✅ 비용 모니터링
- ✅ 디버깅 용이

---

## 📋 슬라이드 10: 기술 스택

### 백엔드
- **프레임워크**: FastAPI
- **데이터베이스**: PostgreSQL
- **ORM**: SQLAlchemy

### AI 모델
- **LLaVA**: 이미지-텍스트 검증
- **YOLO**: 객체 감지
- **GPT**: 텍스트 생성 (OpenAI API)
- **EasyOCR**: OCR 평가

### 인프라
- **컨테이너화**: Docker, Docker Compose
- **이벤트 시스템**: PostgreSQL LISTEN/NOTIFY
- **모니터링**: 자체 구축 추적 시스템

### 최적화
- **메모리**: 8-bit 양자화, Swap Area
- **성능**: Thread-safe 모델 로딩
- **확장성**: 이벤트 기반 아키텍처

---

## 📋 슬라이드 11: 파이프라인 단계 상세

### 전체 파이프라인 (10단계)

#### Variant별 처리 (8단계)
1. **vlm_analyze**: LLaVA Stage 1 - 이미지-텍스트 검증
2. **yolo_detect**: 금지 영역 감지
3. **planner**: 텍스트 배치 계획
4. **overlay**: 텍스트 오버레이 적용
5. **vlm_judge**: LLaVA Stage 2 - 최종 품질 평가
6. **ocr_eval**: OCR 인식 정확도 평가
7. **readability_eval**: 가독성 평가
8. **iou_eval**: 위치 정확도 평가

#### Job 레벨 처리 (2단계)
9. **ad_copy_gen_kor**: 영어 → 한글 변환
10. **instagram_feed_gen**: 인스타그램 피드 글 생성

**특징**: 모든 단계가 자동으로 다음 단계를 트리거

---

## 📋 슬라이드 12: 성능 및 통계

### 파이프라인 성능

**처리 시간** (평균):
- 전체 파이프라인: 약 5-10분 (variant당)
- LLaVA 추론: 약 5-10초 (이미지당)
- YOLO 감지: < 1초 (이미지당)
- GPT API: 약 2-5초 (요청당)

### 메모리 사용량

**LLaVA 모델**:
- FP16: ~14GB
- 8-bit 양자화: ~7GB (50% 절약)

**시스템 메모리**:
- 총 메모리: 15GB
- Swap: 32GB (설정됨)

### 데이터베이스

**테이블 수**: 20+ 테이블
- Job, Variant, Asset 관리
- LLM/VLM Trace 추적
- 평가 결과 저장

---

## 📋 슬라이드 13: 핵심 성과

### 자동화 수준
- ✅ **10단계 파이프라인 완전 자동화**
- ✅ **수동 개입 불필요**
- ✅ **실시간 이벤트 기반 반응**

### 품질 보장
- ✅ **3단계 품질 평가 시스템**
- ✅ **OCR, 가독성, IoU 평가**
- ✅ **고품질 광고 이미지 보장**

### 추적 및 모니터링
- ✅ **모든 LLM 호출 추적**
- ✅ **토큰 사용량 모니터링**
- ✅ **비용 관리 및 최적화**

### 확장성
- ✅ **이벤트 기반 아키텍처**
- ✅ **여러 워커 인스턴스 지원**
- ✅ **부하 분산 가능**

---

## 📋 슬라이드 14: 데모 시나리오

### 사용자 시나리오

```
1. 사용자 입력
   - 한국어 설명: "맛있는 파스타 전문점"
   - 톤&스타일: "친근한"
   - 스토어 정보: "서울 강남구"

2. 자동 처리 (사용자 개입 없음)
   - JS 파트: 텍스트 생성
   - YE 파트: 이미지 생성
   - YH 파트: 이미지 처리 및 평가

3. 결과물
   - 오버레이된 광고 이미지 (3개 variants)
   - 인스타그램 피드 글
   - 해시태그 자동 생성
```

### 처리 시간
- **전체 파이프라인**: 약 5-10분
- **사용자 개입**: 0회

---

## 📋 슬라이드 15: 기술적 혁신

### 1. 이벤트 기반 자동화
- PostgreSQL LISTEN/NOTIFY 활용
- 폴링 방식 대신 실시간 이벤트 기반
- 리소스 효율적

### 2. 메모리 최적화
- 8-bit 양자화로 메모리 50% 절약
- Thread-safe 모델 로딩
- Swap Area 설정

### 3. 완전한 추적 시스템
- 모든 LLM 호출 추적
- 토큰 사용량 모니터링
- 성능 분석 가능

### 4. 자동 복구 메커니즘
- 뒤처진 Variants 자동 복구
- 자동 재시도
- 장애 복구 내장

---

## 📋 슬라이드 16: 아키텍처 다이어그램

### 시스템 아키텍처

```
┌─────────────────────────────────────────────────────┐
│              FastAPI Application                      │
│  ┌───────────────────────────────────────────────┐  │
│  │  Job State Listener                            │  │
│  │  - PostgreSQL LISTEN/NOTIFY 리스너             │  │
│  │  - 자동 재연결                                 │  │
│  │  - 뒤처진 Variants 복구                        │  │
│  └───────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────┐  │
│  │  Pipeline Trigger Service                      │  │
│  │  - 단계별 매핑 테이블                           │  │
│  │  - 자동 API 호출                               │  │
│  │  - 중복 실행 방지                              │  │
│  └───────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────┐  │
│  │  AI Model Services                             │  │
│  │  - LLaVA Service                               │  │
│  │  - YOLO Service                                 │  │
│  │  - GPT Service                                  │  │
│  └───────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────┘
                        ↕
┌─────────────────────────────────────────────────────┐
│              PostgreSQL Database                      │
│  - jobs, jobs_variants                               │
│  - llm_traces, vlm_traces                            │
│  - evaluations                                       │
│  - 트리거 함수 (NOTIFY)                              │
└─────────────────────────────────────────────────────┘
```

---

## 📋 슬라이드 17: 주요 기능 요약

### 7가지 주요 기능 카테고리

1. **자동화 및 트리거 시스템**
   - PostgreSQL LISTEN/NOTIFY
   - 실시간 이벤트 기반
   - 완전 자동화

2. **AI 모델 통합**
   - LLaVA (멀티모달)
   - YOLO (객체 감지)
   - GPT (텍스트 생성)

3. **이미지 처리 및 오버레이**
   - Planner Service
   - Overlay Service
   - 한글 폰트 지원

4. **품질 평가 시스템**
   - OCR 평가
   - 가독성 평가
   - IoU 평가

5. **텍스트 생성 및 변환**
   - 한국어 ↔ 영어 변환
   - 광고문구 생성
   - 인스타그램 피드 생성

6. **모니터링 및 추적**
   - LLM 추적
   - Job 상태 관리
   - 성능 분석

7. **테스트 및 개발 도구**
   - Job Pipeline 모니터링 (`monitor_job_pipeline.py`)
   - 파이프라인 결과 분석 (`analyze_pipeline_results.py`)
   - Background Job Creator (`background_pipeline_with_text_generation.py`)
   - 리스너 상태 확인 도구

---

## 📋 슬라이드 18: 데이터 흐름

### 전체 데이터 흐름

```
[사용자 입력]
  ↓
[job_inputs 테이블]
  ↓
[JS 파트: 텍스트 생성]
  ↓
[txt_ad_copy_generations 테이블]
  ↓
[YE 파트: 이미지 생성]
  ↓
[image_assets 테이블]
  ↓
[YH 파트: 이미지 처리]
  ↓
[overlay_layouts 테이블]
  ↓
[품질 평가]
  ↓
[evaluations 테이블]
  ↓
[최종 텍스트 생성]
  ↓
[instagram_feeds 테이블]
```

**특징**: 모든 단계의 입력/출력이 데이터베이스에 저장되어 완전한 추적 가능

---

## 📋 슬라이드 19: 성능 최적화

### 메모리 최적화

1. **8-bit 양자화**
   - LLaVA 모델 메모리 50% 절약
   - FP16: ~14GB → INT8: ~7GB

2. **Thread-safe 모델 로딩**
   - 모델을 한 번만 로드
   - 여러 스레드가 공유 사용

3. **Swap Area 설정**
   - 32GB swap 파일
   - 메모리 부족 시 자동 사용

### 성능 최적화

1. **이벤트 기반 아키텍처**
   - 폴링 방식 대신 실시간 이벤트
   - 리소스 효율적

2. **자동 복구**
   - 뒤처진 Variants 자동 복구
   - 장애 시 자동 재시도

---

## 📋 슬라이드 20: 프로젝트 통계

### 구현 규모

**코드베이스**:
- Python 파일: 30+ 파일
- 서비스 레이어: 10개 서비스 (job_state_listener, pipeline_trigger, llava_service, yolo_service, planner_service, gpt_service, ocr_service, readability_service, iou_eval_service)
- API 엔드포인트: 15+ 엔드포인트
- 데이터베이스 테이블: 20+ 테이블
- 모니터링 스크립트: monitor_job_pipeline.py, analyze_pipeline_results.py

**파이프라인**:
- 총 단계: 10단계
- Variant별 단계: 8단계 (vlm_analyze → yolo_detect → planner → overlay → vlm_judge → ocr_eval → readability_eval → iou_eval)
- Job 레벨 단계: 2단계 (ad_copy_gen_kor → instagram_feed_gen)

**AI 모델**:
- LLaVA: 7B 파라미터
- YOLO: yolov8x-seg
- GPT: gpt-4o-mini

**문서화**:
- 발표 자료: 11개 문서
- 구현 문서: 15+ 문서
- 테스트 가이드: 5+ 문서

---

## 📋 슬라이드 21: 향후 계획

### 단기 계획
- ✅ 파이프라인 완전 자동화 (완료)
- ✅ 품질 평가 시스템 구축 (완료)
- ✅ 모니터링 시스템 구축 (완료)

### 중기 계획
- 🔄 모델 성능 최적화
- 🔄 처리 속도 개선
- 🔄 에러 처리 강화

### 장기 계획
- 📋 다양한 SNS 플랫폼 지원
- 📋 다국어 지원 확대
- 📋 사용자 맞춤형 생성

---

## 📋 슬라이드 22: 핵심 메시지

### FeedlyAI의 핵심 가치

1. **완전 자동화**
   - 수동 개입 없이 전체 파이프라인 실행
   - 실시간 이벤트 기반 반응

2. **고품질 보장**
   - 다단계 품질 평가 시스템
   - AI 모델 기반 검증

3. **완전한 추적**
   - 모든 LLM 호출 추적
   - 성능 분석 및 비용 관리

4. **확장 가능한 아키텍처**
   - 이벤트 기반 설계
   - 여러 워커 인스턴스 지원

---

## 📋 슬라이드 23: Q&A

### 자주 묻는 질문

**Q1: 처리 시간은 얼마나 걸리나요?**
- A: 전체 파이프라인 약 5-10분 (variant당)

**Q2: 메모리 사용량은 어떻게 되나요?**
- A: LLaVA 모델 8-bit 양자화 시 약 7GB, Swap 32GB 설정

**Q3: 자동화 수준은 어느 정도인가요?**
- A: 10단계 파이프라인 완전 자동화, 수동 개입 불필요

**Q4: 확장성은 어떻게 되나요?**
- A: 이벤트 기반 아키텍처로 여러 워커 인스턴스 지원

---

## 📋 슬라이드 24: 감사합니다

### FeedlyAI 프로젝트

**완전 자동화된 AI 기반 인스타그램 광고 생성 시스템**

**핵심 성과**:
- ✅ 10단계 파이프라인 완전 자동화
- ✅ 실시간 이벤트 기반 아키텍처
- ✅ 다단계 품질 평가 시스템
- ✅ 완전한 추적 및 모니터링

**문의**: 프로젝트 팀

---

**작성일**: 2025-12-02  
**작성자**: LEEYH205  
**버전**: 1.0.0



